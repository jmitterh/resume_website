<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jean Paul - Contact Me</title>
    
    <!-- Theme initialization script -->
    <script>
    (function() {
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        
        const applyToBody = () => {
            if (document.body) {
                document.body.setAttribute('data-theme', savedTheme);
            } else {
                requestAnimationFrame(applyToBody);
            }
        };
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', applyToBody);
        } else {
            applyToBody();
        }
    })();
    </script>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon_io/favicon.ico">
    <link rel="icon" type="image/png" href="/favicon_io/favicon-32x32.png" sizes="32x32">
    <link rel="apple-touch-icon" href="/favicon_io/apple-touch-icon.png">
    <link rel="icon" sizes="192x192" href="/favicon_io/android-chrome-192x192.png">
</head>
<body>
    <div id="loadingSpinner" class="loading-spinner">
        <div class="spinner"></div>
    </div>   
    
    <div class="container">
        <div id="sidebar-placeholder"></div>
        <div class="hamburger" id="hamburger-menu">
            <i class="fas fa-bars"></i>
        </div>

        <div class="row">
            <div class="col-12 w-auto p-3">
                <div class="title">
                    <h1>Contact Me</h1>
                </div>
            </div>
        </div>

        <div class="row justify-content-evenly">
            <div class="col-12 w-auto p-3">
                <section id="contact" class="container my-5">
                    <p style="color: var(--text-primary)">I'm always excited to connect with individuals who share a passion for technology and innovation...</p>
                    
                    <h3 style="color: var(--text-primary)">Get in Touch</h3>
                    
                    <!-- PHP Contact Form -->
                    <form action="sendemail_form.php" method="POST" class="contact-form" id="contactForm">
                        <div class="mb-3">
                            <label for="contactName" class="form-label">Name</label>
                            <input type="text" class="form-control" id="contactName" name="name" placeholder="Your name" required>
                            <div class="invalid-feedback">Please provide your name.</div>
                        </div>

                        <div class="mb-3">
                            <label for="contactEmail" class="form-label">Email address</label>
                            <input type="email" class="form-control" id="contactEmail" name="email" placeholder="name@example.com" required>
                            <div class="invalid-feedback">Please provide a valid email address.</div>
                        </div>

                        <div class="mb-3">
                            <label for="contactMessage" class="form-label">Your Message</label>
                            <textarea class="form-control" id="contactMessage" name="message" rows="4" placeholder="Your message here..." required></textarea>
                            <div class="invalid-feedback">Please provide a message.</div>
                        </div>

                        <!-- Honeypot for spam protection -->
                        <input type="text" name="website" tabindex="-1" autocomplete="off" style="position:absolute;left:-9999px;opacity:0;height:0;width:0;">

                        <button type="submit" class="btn btn-primary" id="submitBtn">
                            <span class="btn-text">Send Message</span>
                            <span class="btn-loading d-none">
                                <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                                Sending...
                            </span>
                        </button>
                    </form>

                    <!-- Status messages -->
                    <div id="formStatus" class="mt-3"></div>

                    <h3 style="color: var(--text-primary)" class="mt-5">References</h3>
                    <p style="color: var(--text-primary)">Professional references are available upon request...</p>
                </section>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/showdown@2.1.0/dist/showdown.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

    <!-- Form handling script -->
    <script>
        // Handle form status messages from URL parameters
        function showFormStatus() {
            const statusDiv = document.getElementById('formStatus');
            const urlParams = new URLSearchParams(window.location.search);
            const status = urlParams.get('status');
            
            if (status === 'sent') {
                statusDiv.className = 'alert alert-success';
                statusDiv.innerHTML = '<strong>Success!</strong> Your message has been saved successfully. I\'ll get back to you soon!';
            } else if (status === 'error') {
                statusDiv.className = 'alert alert-danger';
                statusDiv.innerHTML = '<strong>Error!</strong> There was a problem sending your message. Please try again or contact me directly at jp86mitter@gmail.com.';
            }
            
            // Auto-hide after 8 seconds and clean URL
            if (status) {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                    // Clean URL without reloading page
                    window.history.replaceState({}, document.title, window.location.pathname);
                }, 8000);
            }
        }

        // Form validation and submission handling
        function initializeContactForm() {
            const form = document.getElementById('contactForm');
            const submitBtn = document.getElementById('submitBtn');
            const btnText = submitBtn.querySelector('.btn-text');
            const btnLoading = submitBtn.querySelector('.btn-loading');

            if (form) {
                form.addEventListener('submit', function(event) {
                    // Basic client-side validation
                    const name = document.getElementById('contactName').value.trim();
                    const email = document.getElementById('contactEmail').value.trim();
                    const message = document.getElementById('contactMessage').value.trim();
                    
                    if (!name || !email || !message) {
                        event.preventDefault();
                        form.classList.add('was-validated');
                        return false;
                    }
                    
                    // Email validation
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailRegex.test(email)) {
                        event.preventDefault();
                        form.classList.add('was-validated');
                        return false;
                    }
                    
                    // Show loading state
                    btnText.classList.add('d-none');
                    btnLoading.classList.remove('d-none');
                    submitBtn.disabled = true;
                    
                    // Form will submit normally to PHP
                });
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            showFormStatus();
            initializeContactForm();
        });
    </script>
</body>
</html>